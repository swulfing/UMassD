---
title: "ModelBased EM"
output: html_document
date: "2025-05-14"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

#install.packages('ggplot2')
library(tidyverse)
library(ggdist)
library(Hmisc)
library(mvtnorm)

source("mse-functions.R")

```
# Changes

1. Applying MSE in code chunk "OM" calls fxn em_evaluate. changed to evaluate bc I'm not sure which fxn this refers to

```{r OM}
data.years <- 1991:2013
harvest <- c(0.1,3,15,52,76,139,95,93,84,93,86,103,104,
92,46,67,59,30,54,59,47,33,44)
index <- c(NA,NA,NA,NA,NA,NA,NA,NA,935,NA,1057,NA,678,NA,
420,NA,554,NA,458,NA,474,NA,280)

# Load conditioned OM
schaefer_fit <- readRDS("schaefer_om.rds")
pars.iter <- schaefer_fit$pars
biomass.iter <- schaefer_fit$bio

# ApplY MSE
proj.years <- 2014:2034

project.emhcr <- em_evaluate(pars.iter, biomass.iter, control.pars,
                             data.years, proj.years, iterations=3, true.m = 2, est.m = 2)





```










